<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Networks &mdash; ape  documentation</title>
      <link rel="stylesheet" href="/ape/latest/_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="/ape/latest/_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="/ape/latest/_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="/ape/userguides/networks.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script data-domain="docs.apeworx.io" defer="defer" src="https://plausible.io/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/custom.js"></script>
  <script>
      var PROJECT = "ape";
  </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Forking Networks" href="forking_networks.html" />
    <link rel="prev" title="Querying Data" href="data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ape
              <img src="../_static/logo.gif" class="logo" alt="Logo"/>
          </a>

          <div class="version">
            <label for="version-picker" id="version-picker-label">Version:</label>
            <select id="version-picker">
              <option value="">Select version...</option>
              <option value="latest">latest</option>
              <option value="stable">stable</option>
                <option value="v0.8.12">v0.8.12</option>
                <option value="v0.8.11">v0.8.11</option>
                <option value="v0.8.10">v0.8.10</option>
                <option value="v0.8.9">v0.8.9</option>
                <option value="v0.8.8">v0.8.8</option>
                <option value="v0.8.7">v0.8.7</option>
                <option value="v0.8.6">v0.8.6</option>
                <option value="v0.8.5">v0.8.5</option>
                <option value="v0.8.4">v0.8.4</option>
                <option value="v0.8.3">v0.8.3</option>
                <option value="v0.8.2">v0.8.2</option>
                <option value="v0.8.1">v0.8.1</option>
                <option value="v0.8.0">v0.8.0</option>
                <option value="v0.7.23">v0.7.23</option>
                <option value="v0.7.22">v0.7.22</option>
                <option value="v0.7.21">v0.7.21</option>
                <option value="v0.7.20">v0.7.20</option>
                <option value="v0.7.19">v0.7.19</option>
                <option value="v0.7.18">v0.7.18</option>
                <option value="v0.7.17">v0.7.17</option>
                <option value="v0.7.16">v0.7.16</option>
                <option value="v0.7.15">v0.7.15</option>
                <option value="v0.7.14">v0.7.14</option>
                <option value="v0.7.12">v0.7.12</option>
                <option value="v0.7.11">v0.7.11</option>
                <option value="v0.7.10">v0.7.10</option>
                <option value="v0.7.9">v0.7.9</option>
                <option value="v0.7.8">v0.7.8</option>
                <option value="v0.7.7">v0.7.7</option>
                <option value="v0.7.6">v0.7.6</option>
                <option value="v0.7.5">v0.7.5</option>
                <option value="v0.7.4">v0.7.4</option>
                <option value="v0.7.3">v0.7.3</option>
                <option value="v0.7.2">v0.7.2</option>
                <option value="v0.7.1">v0.7.1</option>
                <option value="v0.7.0">v0.7.0</option>
                <option value="v0.6.27">v0.6.27</option>
                <option value="v0.6.26">v0.6.26</option>
                <option value="v0.6.25">v0.6.25</option>
                <option value="v0.6.24">v0.6.24</option>
                <option value="v0.6.23">v0.6.23</option>
                <option value="v0.6.22">v0.6.22</option>
                <option value="v0.6.21">v0.6.21</option>
                <option value="v0.6.20">v0.6.20</option>
                <option value="v0.6.19">v0.6.19</option>
                <option value="v0.6.18">v0.6.18</option>
                <option value="v0.6.17">v0.6.17</option>
                <option value="v0.6.16">v0.6.16</option>
                <option value="v0.6.15">v0.6.15</option>
                <option value="v0.6.14">v0.6.14</option>
                <option value="v0.6.13">v0.6.13</option>
                <option value="v0.6.12">v0.6.12</option>
                <option value="v0.6.11">v0.6.11</option>
                <option value="v0.6.10">v0.6.10</option>
                <option value="v0.6.9">v0.6.9</option>
                <option value="v0.6.8">v0.6.8</option>
                <option value="v0.6.7">v0.6.7</option>
                <option value="v0.6.6">v0.6.6</option>
                <option value="v0.6.5">v0.6.5</option>
                <option value="v0.6.4">v0.6.4</option>
                <option value="v0.6.3">v0.6.3</option>
                <option value="v0.6.2">v0.6.2</option>
                <option value="v0.6.1">v0.6.1</option>
                <option value="v0.6.0">v0.6.0</option>
                <option value="v0.5.9">v0.5.9</option>
                <option value="v0.5.8">v0.5.8</option>
                <option value="v0.5.7">v0.5.7</option>
                <option value="v0.5.6">v0.5.6</option>
                <option value="v0.5.5">v0.5.5</option>
                <option value="v0.5.4">v0.5.4</option>
                <option value="v0.5.3">v0.5.3</option>
                <option value="v0.5.2">v0.5.2</option>
                <option value="v0.5.1">v0.5.1</option>
                <option value="v0.5.0">v0.5.0</option>
                <option value="v0.4.5">v0.4.5</option>
                <option value="v0.4.4">v0.4.4</option>
                <option value="v0.4.3">v0.4.3</option>
                <option value="v0.4.2">v0.4.2</option>
                <option value="v0.4.1">v0.4.1</option>
                <option value="v0.4.0">v0.4.0</option>
                <option value="v0.3.5">v0.3.5</option>
                <option value="v0.3.4">v0.3.4</option>
                <option value="v0.3.3">v0.3.3</option>
                <option value="v0.3.2">v0.3.2</option>
                <option value="v0.3.1">v0.3.1</option>
                <option value="v0.3.0">v0.3.0</option>
                <option value="v0.2.8">v0.2.8</option>
                <option value="v0.2.7">v0.2.7</option>
                <option value="v0.2.6">v0.2.6</option>
                <option value="v0.2.5">v0.2.5</option>
                <option value="v0.2.4">v0.2.4</option>
                <option value="v0.2.3">v0.2.3</option>
                <option value="v0.2.2">v0.2.2</option>
                <option value="v0.2.1">v0.2.1</option>
                <option value="v0.2.0">v0.2.0</option>
                <option value="v0.1.6">v0.1.6</option>
                <option value="v0.1.5">v0.1.5</option>
                <option value="v0.1.4">v0.1.4</option>
                <option value="v0.1.3">v0.1.3</option>
                <option value="v0.1.1">v0.1.1</option>
                <option value="v0.1.0">v0.1.0</option>
            </select>
          </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="accounts.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing_plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Developing Projects with Ape</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="compile.html">Compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="clis.html">CLIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Querying Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#selecting-a-network">Selecting a Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#l2-networks">L2 Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-network-connection">Custom Network Connection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#custom-networks-by-config">Custom Networks By Config</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rpc-url">RPC URL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forking-custom-networks">Forking Custom Networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#explorer-url">Explorer URL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block-time-transaction-type-and-more-config">Block time, transaction type, and more config</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#custom-networks-by-cli">Custom Networks by CLI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-networks">Configuring Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-network">Local Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#live-networks">Live Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-config">Network Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-a-network-process">Running a Network Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#provider-interaction">Provider Interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#provider-context-manager">Provider Context Manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#forked-context">Forked Context</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forking_networks.html">Forking Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing_plugins.html">Developing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configure Ape</a></li>
<li class="toctree-l1"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html">Ape Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="contracts.html">Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="reverts.html">Reverts</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="publishing.html">Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="trace.html">Traces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../commands/accounts.html">accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/compile.html">compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/pm.html">pm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/console.html">console</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/init.html">init</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/networks.html">networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/plugins.html">plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/run.html">run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/test.html">test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape.html">ape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/api.html">ape.api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/cli.html">ape.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/contracts.html">ape.contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/exceptions.html">ape.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/managers.html">ape.managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/plugins.html">ape.plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/types.html">ape.types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/utils.html">ape.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plugin Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_accounts.html">ape-accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_compile.html">ape-compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_ethereum.html">ape-ethereum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_ethereum.html#module-ape_ethereum.multicall">ape-ethereum.multicall</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_node.html">ape-node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_pm.html">ape-pm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_test.html">ape-test</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ape</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Networks</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ApeWorX/ape/blob/main/docs/userguides/networks.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="networks">
<h1>Networks<a class="headerlink" href="#networks" title="Permalink to this heading"></a></h1>
<p>When interacting with a blockchain, you will have to select an ecosystem (e.g. Ethereum, Arbitrum, or Fantom), a network (e.g. Mainnet or Sepolia) and a provider (e.g. Eth-Tester, Node (Geth), or Alchemy).
Networks are part of ecosystems and typically defined in plugins.
For example, the <code class="docutils literal notranslate"><span class="pre">ape-ethereum</span></code> plugin comes with Ape and can be used for handling EVM-like behavior.</p>
<section id="selecting-a-network">
<h2>Selecting a Network<a class="headerlink" href="#selecting-a-network" title="Permalink to this heading"></a></h2>
<p>Before discussing how to add custom networks or install L2 network plugins, you need to know how to specify the network choice.
No matter what type of network you are using in Ape, you specify the network using a “network choice” triplet value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&lt;ecosystem-name&gt;:&lt;network-name&gt;:&lt;provider-name&gt;&quot;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">ecosystem-name</span></code> refers to the ecosystem, e.g. <code class="docutils literal notranslate"><span class="pre">ethereum</span></code>, <code class="docutils literal notranslate"><span class="pre">polygon</span></code>, <code class="docutils literal notranslate"><span class="pre">fantom</span></code>, or any valid ecosystem plugin name.
The <code class="docutils literal notranslate"><span class="pre">network-name</span></code> refers to a network such as <code class="docutils literal notranslate"><span class="pre">mainnet</span></code>, <code class="docutils literal notranslate"><span class="pre">local</span></code>, or something else defined by your ecosystem or custom network config.
And <code class="docutils literal notranslate"><span class="pre">provider-name</span></code> refers to the provider plugin in Ape, such as <code class="docutils literal notranslate"><span class="pre">node</span></code> for a generic node or <code class="docutils literal notranslate"><span class="pre">foundry</span></code> if the network is more Anvil-based, or a different plugin altogether.</p>
<p>Commonly, the network triplet value is specified via the <code class="docutils literal notranslate"><span class="pre">--network</span></code> option in Ape CLI commands.
The following is a list of common Ape commands that can use the <code class="docutils literal notranslate"><span class="pre">--network</span></code> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--network<span class="w"> </span>ethereum:local:foundry
ape<span class="w"> </span>console<span class="w"> </span>--network<span class="w"> </span>arbitrum:testnet:alchemy<span class="w"> </span><span class="c1"># NOTICE: All networks, even from other ecosystems, use this.</span>
</pre></div>
</div>
<p>To see all possible values for <code class="docutils literal notranslate"><span class="pre">--network</span></code>, run the command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>networks<span class="w"> </span>list
</pre></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">--network</span></code> option on scripts that use the <code class="docutils literal notranslate"><span class="pre">main()</span></code> method approach or scripts that implement that <code class="docutils literal notranslate"><span class="pre">ConnectedProviderCommand</span></code> command type.
See <a class="reference external" href="./scripts.html">the scripting guide</a> to learn more about scripts and how to add the network option.</p>
<p>Also, you can omit values to use defaults.
For example, the default ecosystem is <code class="docutils literal notranslate"><span class="pre">ethereum</span></code> and the default network is <code class="docutils literal notranslate"><span class="pre">local</span></code>, so you can do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>run<span class="w"> </span>&lt;custom-cmd&gt;<span class="w"> </span>--network<span class="w"> </span>::foundry
</pre></div>
</div>
<p>as a short-cut for <code class="docutils literal notranslate"><span class="pre">ethereum:local:foundry</span></code>.
(note: <code class="docutils literal notranslate"><span class="pre">&lt;custom-command&gt;</span></code> refers to the name of a script that uses the network option or is a <code class="docutils literal notranslate"><span class="pre">ConnectedProviderCommand</span></code>.
See the <a class="reference external" href="./scripts.html">scripting guide</a> for more information).</p>
<p>Next, we will talk about how to add additional networks to your Ape environment.</p>
</section>
<section id="l2-networks">
<h2>L2 Networks<a class="headerlink" href="#l2-networks" title="Permalink to this heading"></a></h2>
<p>Common L2 networks, such as Arbitrum, Polygon, Optimism, or Fantom, have ApeWorX-maintained (trusted) plugins that override the Ethereum ecosystem API class and change any defaults that are needed.
You can install these plugins by doing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>plugins<span class="w"> </span>install<span class="w"> </span>arbitrum<span class="w"> </span>polygon<span class="w"> </span>optimism<span class="w"> </span>fantom
</pre></div>
</div>
<p>Each plugin does different things.
In general, L2 plugins are very small and override the Ethereum ecosystem class.
Here are some examples of changes L2 plugins make that allow improved support for these networks:</p>
<ol class="arabic simple">
<li><p>Networks that don’t support EIP-1559 transactions use Static-fee transaction types by default whereas <code class="docutils literal notranslate"><span class="pre">ape-ethereum</span></code> will use EIP-1559 transactions by default.</p></li>
<li><p>Some networks, such as <code class="docutils literal notranslate"><span class="pre">ape-arbitrum</span></code>, have unique transaction types (and receipt types!) that are handled in the plugin.
This logic does not have to live in the base <code class="docutils literal notranslate"><span class="pre">ape-ethereum</span></code> plugin but can live in the network’s custom plugin.</p></li>
<li><p>Fee token information: When displaying gas reports or other data, network plugins can use the correct fee-token symbols, such as Polygon MATIC.</p></li>
</ol>
<p>Here is a list of all L2 network plugins supported by Ape:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>GitHub</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ape-arbitrum</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-arbitrum">ApeWorX/ape-arbitrum</a></p></td>
</tr>
<tr class="row-odd"><td><p>ape-avalanche</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-avalanche">ApeWorX/ape-avalanche</a></p></td>
</tr>
<tr class="row-even"><td><p>ape-base</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-base">ApeWorX/ape-base</a></p></td>
</tr>
<tr class="row-odd"><td><p>ape-blast</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-blast">ApeWorX/ape-base</a></p></td>
</tr>
<tr class="row-even"><td><p>ape-bsc</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-bsc">ApeWorX/ape-base</a></p></td>
</tr>
<tr class="row-odd"><td><p>ape-fantom</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-fantom">ApeWorX/ape-fantom</a></p></td>
</tr>
<tr class="row-even"><td><p>ape-optimism</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-optimism">ApeWorX/ape-optimism</a></p></td>
</tr>
<tr class="row-odd"><td><p>ape-polygon</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-polygon">ApeWorX/ape-polygon</a></p></td>
</tr>
<tr class="row-even"><td><p>ape-polygon-zkevm</p></td>
<td><p><a class="reference external" href="https://github.com/ApeWorX/ape-polygon-zkevm">ApeWorX/ape-polygon-zkevm</a></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are connecting an L2 network or any other network that does not have a plugin, you can use the custom network support, which is described in the <a class="reference external" href="#custom-network-connection">next section</a>.</p>
</div>
<p>Once you have the L2 network plugin installed, you can configure its node’s URI by setting the values in the <code class="docutils literal notranslate"><span class="pre">node</span></code> core plugin via your <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">node</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;ecosystem-name&gt;</span><span class="p">:</span>
<span class="w">    </span><span class="nt">&lt;network-name&gt;</span><span class="p">:</span>
<span class="w">      </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://path.to.node.example.com</span>
</pre></div>
</div>
<p>To see proper ecosystem and network names needed for configuration, run the command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>networks<span class="w"> </span>list
</pre></div>
</div>
<p>In the remainder of this guide, any example below using Ethereum, you can replace with an L2 ecosystem’s name and network combination.</p>
</section>
<section id="custom-network-connection">
<h2>Custom Network Connection<a class="headerlink" href="#custom-network-connection" title="Permalink to this heading"></a></h2>
<p>You can add custom networks to Ape without creating a plugin.
The two ways to do this are:</p>
<ol class="arabic simple">
<li><p>Create custom network configurations in your <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file (typically your global one).</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">--network</span></code> flag with a raw URI string.</p></li>
</ol>
<section id="custom-networks-by-config">
<h3>Custom Networks By Config<a class="headerlink" href="#custom-networks-by-config" title="Permalink to this heading"></a></h3>
<p>The most familiar way to use custom networks (non-plugin-based networks) in Ape is to use the <code class="docutils literal notranslate"><span class="pre">networks:</span> <span class="pre">custom</span></code> configuration.
Generally, you want to use the global <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code>, which is located in your <code class="docutils literal notranslate"><span class="pre">$HOME/.ape/</span></code> directory.
By configuring networks globally, you can share them across all your projects.
More information about configuring Ape (in general) can be found <a class="reference external" href="./contracts.html">here</a>.</p>
<p>To add custom networks to your <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file, follow this pattern:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">custom</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mainnet</span><span class="w">                   </span><span class="c1"># Required</span>
<span class="w">       </span><span class="nt">chain_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">109</span><span class="w">                   </span><span class="c1"># Required</span>
<span class="w">       </span><span class="nt">ecosystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shibarium</span><span class="w">            </span><span class="c1"># The ecosystem name, can either be new or an existing</span>
<span class="w">       </span><span class="nt">base_ecosystem_plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">polygon</span><span class="w">  </span><span class="c1"># The ecosystem base-class, defaults to the default ecosystem</span>
<span class="w">       </span><span class="nt">default_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node</span><span class="w">          </span><span class="c1"># Default is the generic node provider</span>
</pre></div>
</div>
<p>The following paragraphs explain the different parameters of the custom network config.</p>
<p><strong>name</strong>: The <code class="docutils literal notranslate"><span class="pre">name</span></code> of the network is the same identifier you use in the network triplet for the “network” (second) section.
Read more on the network option <a class="reference external" href="#selecting-a-network">here</a>.</p>
<p><strong>chain_id</strong>: The chain ID is required for config-based custom networks.
It ensures you are on the correct network when making transactions and is very important!</p>
<p><strong>ecosystem</strong>: Specify your custom network’s ecosystem.
This can either be an existing ecosystem or a new name entirely.
Recall, you refer to your network via the network-triplet <code class="docutils literal notranslate"><span class="pre">ecosystem:network:provider</span></code> option-str.
The ecosystem class is largely responsible for decoding and encoding data to-and-fro the blockchain but also contains all the networks.
More information about the EcosystemAPI can be found <a class="reference external" href="../methoddocs/api.html#ape.api.networks.EcosystemAPI">here</a>.
If your custom network is part of a new ecosystem, such as Shibarium, use the name of the new ecosystem, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;shibarium&quot;</span></code>.
You may want to also adjust the <code class="docutils literal notranslate"><span class="pre">base_ecosystem_plugin</span></code> config to change the base-class used.</p>
<p><strong>base_ecosystem_plugin</strong>: The plugin that defines the base-class to your custom ecosystem containing your custom network(s).
If your custom network’s ecosystem matches closer to another L2 instead of Ethereum, use that ecosystem name as your <code class="docutils literal notranslate"><span class="pre">base_ecosystem_plugin</span></code> in your custom network config.
For example, take note that <code class="docutils literal notranslate"><span class="pre">&quot;ethereum&quot;</span></code> assumes EIP-1559 exists (unless configured otherwise).
If your custom network is closer to Fantom, Polygon, Avalanche, or any other L2, you may want to consider using one of those plugins as the <code class="docutils literal notranslate"><span class="pre">base_ecosystem_plugin</span></code> to your custom network.
Alternatively, you can configure your custom network the same way you configure any other network in the config (see <a class="reference external" href="#block-time-transaction-type-and-more-config">this section</a>).</p>
<p><strong>default_provider</strong>: The default provider is the provider class used for making the connection to your custom network, unless you specify a different provider (hence the <code class="docutils literal notranslate"><span class="pre">default_</span></code>).
Generally, you won’t change this and can use the default EVM node provider.
Many provider plugins won’t function here, such as <code class="docutils literal notranslate"><span class="pre">ape-infura</span></code> or <code class="docutils literal notranslate"><span class="pre">ape-alchemy</span></code>.
If you are using one of their networks, it is best to edit and use the plugins directly.
If you are using a developer-node remotely, such as a custom Anvil node, you can specify the default provider to be <code class="docutils literal notranslate"><span class="pre">foundry</span></code> instead.
However, take care in making sure you set up Foundry to correctly connect to your node.
Likewise, when using the default Ethereum node provider, you will need to tell it the RPC URL.</p>
<section id="rpc-url">
<h4>RPC URL<a class="headerlink" href="#rpc-url" title="Permalink to this heading"></a></h4>
<p>To configure the RPC URL for a custom network, use the configuration of the provider.
For example, if the RPC URL is <code class="docutils literal notranslate"><span class="pre">https://apenet.example.com/rpc</span></code>, configure it by doing:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default_ecosystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shibarium</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">custom</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mainnet</span>
<span class="w">      </span><span class="nt">ecosystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shibarium</span>
<span class="w">      </span><span class="nt">base_ecosystem_plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">polygon</span><span class="w">  </span><span class="c1"># Closest base class.</span>
<span class="w">      </span><span class="nt">chain_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">109</span><span class="w">  </span><span class="c1"># This must be correct or txns will fail.</span>

<span class="nt">node</span><span class="p">:</span>
<span class="w">  </span><span class="nt">shibarium</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mainnet</span><span class="p">:</span>
<span class="w">      </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.shibrpc.com</span>
</pre></div>
</div>
<p>Now, when using <code class="docutils literal notranslate"><span class="pre">ethereum:apenet:node</span></code>, it will connect to the RPC URL <code class="docutils literal notranslate"><span class="pre">https://apenet.example.com/rpc</span></code>.</p>
</section>
<section id="forking-custom-networks">
<h4>Forking Custom Networks<a class="headerlink" href="#forking-custom-networks" title="Permalink to this heading"></a></h4>
<p>You can fork custom networks using providers that support forking, such as <code class="docutils literal notranslate"><span class="pre">ape-foundry</span></code> or <code class="docutils literal notranslate"><span class="pre">ape-hardhat</span></code>.
To fork a custom network, first ensure the custom network is set-up by following the sections above.
Once you can successfully connect to a custom network in Ape, you can fork it.</p>
<p>To fork the network, launch an Ape command with the <code class="docutils literal notranslate"><span class="pre">--network</span></code> option with your custom network name suffixed with <code class="docutils literal notranslate"><span class="pre">-fork</span></code> and use one of the forking providers (such as <code class="docutils literal notranslate"><span class="pre">ape-foundry</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ape</span> <span class="o">&lt;</span><span class="n">cmd</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">network</span> <span class="n">shibarium</span><span class="p">:</span><span class="n">puppynet</span><span class="o">-</span><span class="n">fork</span><span class="p">:</span><span class="n">foundry</span>
</pre></div>
</div>
<p>Configure the forked network in the plugin the same way you configure other forked networks:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">foundry</span><span class="p">:</span>
<span class="w">  </span><span class="nt">fork</span><span class="p">:</span>
<span class="w">    </span><span class="nt">shibarium</span><span class="p">:</span>
<span class="w">      </span><span class="nt">puppynet</span><span class="p">:</span>
<span class="w">        </span><span class="nt">block_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
</pre></div>
</div>
</section>
<section id="explorer-url">
<h4>Explorer URL<a class="headerlink" href="#explorer-url" title="Permalink to this heading"></a></h4>
<p>To configure explorer URLs for your custom network, use the explorer’s plugin config.
For example, let’s say you added the following network:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">custom</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customnetwork</span>
<span class="w">      </span><span class="nt">chain_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">31337</span>
<span class="w">      </span><span class="nt">default_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node</span>
</pre></div>
</div>
<p>To add a corresponding entry in <code class="docutils literal notranslate"><span class="pre">ape-etherscan</span></code> (assuming you are using <code class="docutils literal notranslate"><span class="pre">ape-etherscan</span></code> as your explorer plugin), add the following to your <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">etherscan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ethereum</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rate_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span><span class="w">  </span><span class="c1"># Configure a rate limit that makes sense for retry logic.</span>

<span class="w">    </span><span class="c1"># The name of the entry is the same as your custom network!</span>
<span class="w">    </span><span class="nt">customnetwork</span><span class="p">:</span>
<span class="w">      </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://custom.scan</span><span class="w">              </span><span class="c1"># URL used for showing transactions</span>
<span class="w">      </span><span class="nt">api_uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://api.custom.scan/api</span><span class="w">  </span><span class="c1"># URL used for making API requests.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every explorer plugin may be different in how you configure custom networks.
Consult the plugin’s README to clarify.</p>
</div>
</section>
<section id="block-time-transaction-type-and-more-config">
<h4>Block time, transaction type, and more config<a class="headerlink" href="#block-time-transaction-type-and-more-config" title="Permalink to this heading"></a></h4>
<p>Configuring network properties in Ape is the same regardless of whether it is custom or not.
As you saw above, we set the RPC URL of the custom network the same as if a plugin existed for that network.
The same is true for network config properties such as <code class="docutils literal notranslate"><span class="pre">block_time</span></code>, <code class="docutils literal notranslate"><span class="pre">default_transaction_type</span></code>, <code class="docutils literal notranslate"><span class="pre">transaction_acceptance_timeout</span></code> and more.</p>
<p>For example, let’s say I want to change the default transaction type for the <code class="docutils literal notranslate"><span class="pre">apenet</span></code> custom network (defined in examples above).
I do this the same way as if I were changing the default transaction type on mainnet.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ethereum</span><span class="p">:</span>
<span class="w">  </span><span class="nt">apenet</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_transaction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># Use static-fee transactions for my custom network!</span>
</pre></div>
</div>
<p>For a full list of network configurations like this (for both custom and plugin-based networks), <a class="reference external" href="#configuring-networks">see this section</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This also works if configuring a custom ecosystem.</p>
</div>
<p>If using a custom ecosystem, use the custom ecosystem name as the top-level config key instead:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">custom</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mainnet</span>
<span class="w">      </span><span class="nt">ecosystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shibarium</span>
<span class="w">      </span><span class="nt">base_ecosystem_plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">polygon</span><span class="w">  </span><span class="c1"># Closest base class.</span>
<span class="w">      </span><span class="nt">chain_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">109</span><span class="w">  </span><span class="c1"># This must be correct or txns will fail.</span>

<span class="nt">shibarium</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mainnet</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_transaction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># Use static-fee transactions for Shibarium.</span>
</pre></div>
</div>
</section>
</section>
<section id="custom-networks-by-cli">
<h3>Custom Networks by CLI<a class="headerlink" href="#custom-networks-by-cli" title="Permalink to this heading"></a></h3>
<p>Ape also lets you connect to custom networks on-the-fly!
If you would like to connect to a URI using an existing ecosystem plugin, you can specify a URI in the provider-section for the <code class="docutils literal notranslate"><span class="pre">--network</span></code> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>run<span class="w"> </span>script<span class="w"> </span>--network<span class="w"> </span>&lt;ecosystem-name&gt;:&lt;network-name&gt;:https://foo.bar
</pre></div>
</div>
<p>Additionally, if you want to connect to an unknown ecosystem or network, you can use the URI by itself.
This uses the default Ethereum ecosystem class.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>run<span class="w"> </span>script<span class="w"> </span>--network<span class="w"> </span>https://foo.bar
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The recommended approach is to use an L2 plugin when one exists, as it will integrate better in the Ape ecosystem.</p>
</div>
<p>Here are some general reason why Network plugins are recommended:</p>
<ol class="arabic simple">
<li><p>You may need to integrate with other plugins, such as explorer plugins for getting contract types.</p></li>
<li><p>Some chains may not implement EIP-1559 or may have forked from a specific configuration.</p></li>
<li><p>Response differences in uncommon blocks, such as the <code class="docutils literal notranslate"><span class="pre">&quot;pending&quot;</span></code> block or the genesis block.</p></li>
<li><p>Revert messages and exception-handling differences.</p></li>
<li><p>You can handle chain differences such as different transaction types in Arbitrum, non-EVM chains and behaviors like Starknet.</p></li>
</ol>
</section>
</section>
<section id="configuring-networks">
<h2>Configuring Networks<a class="headerlink" href="#configuring-networks" title="Permalink to this heading"></a></h2>
<p>Change network defaults using your project’s <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file.
The following configuration changes the default ecosystem, network, and provider such that if you omitted the <code class="docutils literal notranslate"><span class="pre">--network</span></code> option on connected-provider commands, it would use the value <code class="docutils literal notranslate"><span class="pre">&lt;ecosystem-name&gt;:&lt;network-name&gt;:&lt;provider-name&gt;</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default_ecosystem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;ecosystem-name&gt;</span>

<span class="nt">&lt;ecosystem-name&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default_network</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;network-name&gt;</span>
<span class="w">  </span><span class="nt">&lt;network-name&gt;</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;provider-name&gt;</span>
</pre></div>
</div>
<p>As mentioned <a class="reference external" href="#l2-networks">above</a>, ecosystems and networks typically come from plugins and their names and values are defined in those plugins.
The ecosystem name goes in placeholder <code class="docutils literal notranslate"><span class="pre">&lt;ecosystem-name&gt;</span></code> and the network names go in place for <code class="docutils literal notranslate"><span class="pre">&lt;network-name&gt;</span></code>.</p>
<p><strong>If you are unsure of the values to place here, run the following command</strong>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>networks<span class="w"> </span>list
</pre></div>
</div>
<p>This command lists all the ecosystem names and networks names installed currently in Ape.
Place the identical name in the config to configure that ecosystem or network.</p>
<p>You may also configure a specific gas limit for a given network:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ecosystem-name&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default_network</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;network-name&gt;</span>
<span class="w">  </span><span class="nt">&lt;network-name&gt;</span><span class="p">:</span>
<span class="w">    </span><span class="nt">gas_limit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;max&quot;</span>
</pre></div>
</div>
<p>You may use one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> - gas limit is estimated for each transaction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> - the maximum block gas limit is used</p></li>
<li><p>A number or numeric string, base 10 or 16 (e.g. <code class="docutils literal notranslate"><span class="pre">1234</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;1234&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">0x1234</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;0x1234&quot;</span></code>)</p></li>
</ul>
<p>For the local network configuration, the default is <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>. Otherwise, it is <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code>.</p>
</section>
<section id="local-network">
<h2>Local Network<a class="headerlink" href="#local-network" title="Permalink to this heading"></a></h2>
<p>The default network in Ape is the local network (keyword <code class="docutils literal notranslate"><span class="pre">&quot;local&quot;</span></code>).
It is meant for running tests and debugging contracts.
Out-of-the-box, Ape ships with two development providers you can use for the <code class="docutils literal notranslate"><span class="pre">local</span></code> network:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ethereum/eth-tester">EthTester</a></p></li>
<li><p>An Ephemeral Node (defaults to Geth) process</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--network<span class="w"> </span>::test
ape<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--network<span class="w"> </span>::node<span class="w">  </span><span class="c1"># Launch a local development node (geth) process</span>
</pre></div>
</div>
<p>To learn more about testing in ape, follow <a class="reference external" href="./testing.html">this guide</a>.</p>
</section>
<section id="live-networks">
<h2>Live Networks<a class="headerlink" href="#live-networks" title="Permalink to this heading"></a></h2>
<p>Use the core plugin <code class="docutils literal notranslate"><span class="pre">ape-node</span></code> to connect to local or remote nodes via URI.
The node plugin is abstract in that it represents any node.
However, it will work best when connected to a geth node.
To configure network URIs in <code class="docutils literal notranslate"><span class="pre">node</span></code>, you can use the <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">node</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># When managing or running a node, configure an IPC path globally (optional)</span>
<span class="w">  </span><span class="nt">ipc_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/geth.ipc</span>

<span class="w">  </span><span class="nt">ethereum</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mainnet</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># For `uri`, you can use either HTTP, WS, or IPC values.</span>
<span class="w">      </span><span class="c1"># **Most often, you only need HTTP!**</span>
<span class="w">      </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://foo.node.example.com</span>
<span class="w">      </span><span class="c1"># uri: wss://bar.feed.example.com</span>
<span class="w">      </span><span class="c1"># uri: path/to/mainnet/geth.ipc</span>
<span class="w">      </span>
<span class="w">      </span><span class="c1"># For strict HTTP connections, you can configure a http_uri directly.</span>
<span class="w">      </span><span class="nt">http_uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://foo.node.example.com</span>

<span class="w">      </span><span class="c1"># You can also configure a websockets URI (used by Silverback SDK).</span>
<span class="w">      </span><span class="nt">ws_uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wss://bar.feed.example.com</span>
<span class="w">    </span>
<span class="w">      </span><span class="c1"># Specify per-network IPC paths as well.</span>
<span class="w">      </span><span class="nt">ipc_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path/to/mainnet/geth.ipc</span>
</pre></div>
</div>
</section>
<section id="network-config">
<h2>Network Config<a class="headerlink" href="#network-config" title="Permalink to this heading"></a></h2>
<p>There are many ways to configure your networks.
Most of the time, Ape and its L2 plugins configure the best defaults automatically.
Thus, you most likely won’t need to modify these configurations.
However, you do need to configure these if you wish to stray from a network’s defaults.
The following example shows how to do this.
(note: even though this example uses <code class="docutils literal notranslate"><span class="pre">ethereum:mainnet</span></code>, you can use any of the L2 networks mentioned above, as they all have these config properties).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ethereum</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mainnet</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Ethereum mainnet in Ape uses EIP-1559 by default,</span>
<span class="w">    </span><span class="c1"># but we can change that here. Note: most plugins</span>
<span class="w">    </span><span class="c1"># use type 0 by default already, so you don&#39;t need</span>
<span class="w">    </span><span class="c1"># to change this if using an `ape-&lt;l2&gt;` plugin.</span>
<span class="w">    </span><span class="nt">default_transaction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="w">    </span><span class="c1"># The amount of time to wait for a transaction to be</span>
<span class="w">    </span><span class="c1"># accepted after sending it before raising an error.</span>
<span class="w">    </span><span class="c1"># Most networks use 120 seconds (2 minutes).</span>
<span class="w">    </span><span class="nt">transaction_acceptance_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>

<span class="w">    </span><span class="c1"># The amount of times to retry fetching a receipt. This is useful</span>
<span class="w">    </span><span class="c1"># because decentralized systems may show the transaction accepted</span>
<span class="w">    </span><span class="c1"># on some nodes but not on others, and potentially RPC requests</span>
<span class="w">    </span><span class="c1"># won&#39;t return a receipt immediately after sending its transaction.</span>
<span class="w">    </span><span class="c1"># This config accounts for such delay. The default is `20`.</span>
<span class="w">    </span><span class="nt">max_receipt_retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="w">    </span><span class="c1"># Set a gas limit here, or use the default of &quot;auto&quot; which</span>
<span class="w">    </span><span class="c1"># estimates gas. Note: local networks tend to use &quot;max&quot; here</span>
<span class="w">    </span><span class="c1"># by default.</span>
<span class="w">    </span><span class="nt">gas_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auto</span>

<span class="w">    </span><span class="c1"># Base-fee multipliers are useful for times when the base fee changes</span>
<span class="w">    </span><span class="c1"># before a transaction is sent but after the base fee was derived,</span>
<span class="w">    </span><span class="c1"># thus causing rejection. A multiplier reduces the chance of</span>
<span class="w">    </span><span class="c1"># rejection. The default for live networks is `1.4` times the base fee.</span>
<span class="w">    </span><span class="nt">base_fee_multiplier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.2</span>

<span class="w">    </span><span class="c1"># The block time helps Ape make decisions about</span>
<span class="w">    </span><span class="c1"># polling chain data.</span>
<span class="w">    </span><span class="nt">block_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
</section>
<section id="running-a-network-process">
<h2>Running a Network Process<a class="headerlink" href="#running-a-network-process" title="Permalink to this heading"></a></h2>
<p>To run a network with a process, use the <code class="docutils literal notranslate"><span class="pre">ape</span> <span class="pre">networks</span> <span class="pre">run</span></code> command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>networks<span class="w"> </span>run
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">ape</span> <span class="pre">networks</span> <span class="pre">run</span></code> runs a development Node (geth) process.
To use a different network, such as <code class="docutils literal notranslate"><span class="pre">hardhat</span></code> or Anvil nodes, use the <code class="docutils literal notranslate"><span class="pre">--network</span></code> flag:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>networks<span class="w"> </span>run<span class="w"> </span>--network<span class="w"> </span>ethereum:local:foundry
</pre></div>
</div>
</section>
<section id="provider-interaction">
<h2>Provider Interaction<a class="headerlink" href="#provider-interaction" title="Permalink to this heading"></a></h2>
<p>Once you are connected to a network, you now have access to a <code class="docutils literal notranslate"><span class="pre">.provider</span></code>.
The provider class is what higher level Manager classes in Ape use to interface with the blockchain.
You can call methods directly from the provider, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">chain</span>

<span class="n">block</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">get_block</span><span class="p">(</span><span class="s2">&quot;latest&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="provider-context-manager">
<h2>Provider Context Manager<a class="headerlink" href="#provider-context-manager" title="Permalink to this heading"></a></h2>
<p>Use the <a class="reference external" href="../methoddocs/api.html#ape.api.networks.ProviderContextManager">ProviderContextManager</a> to change the network-context in Python.
When entering a network for the first time, it will connect to that network.
<strong>You do not need to call <code class="docutils literal notranslate"><span class="pre">.connect()</span></code> or <code class="docutils literal notranslate"><span class="pre">.disconnect()</span></code> manually</strong>.</p>
<p>For example, if you are using a script with a default network connection, you can change connection in the middle of the script by using the provider context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">networks</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">start_provider</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">name</span>
    <span class="k">with</span> <span class="n">networks</span><span class="o">.</span><span class="n">ethereum</span><span class="o">.</span><span class="n">mainnet</span><span class="o">.</span><span class="n">use_provider</span><span class="p">(</span><span class="s2">&quot;node&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">provider</span><span class="p">:</span>
        <span class="c1"># We are using a different provider than the one we started with.</span>
        <span class="k">assert</span> <span class="n">start_provider</span> <span class="o">!=</span> <span class="n">provider</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>Jump between networks to simulate multi-chain behavior.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">click</span>
<span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">networks</span>

<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">networks</span><span class="o">.</span><span class="n">polygon</span><span class="o">.</span><span class="n">mainnet</span><span class="o">.</span><span class="n">use_provider</span><span class="p">(</span><span class="s2">&quot;node&quot;</span><span class="p">):</span>
        <span class="o">...</span>
    <span class="k">with</span> <span class="n">networks</span><span class="o">.</span><span class="n">ethereum</span><span class="o">.</span><span class="n">mainnet</span><span class="o">.</span><span class="n">use_provider</span><span class="p">(</span><span class="s2">&quot;node&quot;</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>The argument to <a class="reference external" href="../methoddocs/api.html#ape.api.networks.NetworkAPI.use_provider">use_provider()</a> is the name of the provider you want to use.
You can also tell Ape to use the default provider by calling method <a class="reference external" href="../methoddocs/api.html#ape.api.networks.NetworkAPI.use_default_provider">use_default_provider()</a> instead.
This will use whatever provider is set as default for your ecosystem / network combination (via one of your <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> files).</p>
<p>For example, let’s say I have a default provider set like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">arbitrum</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mainnet</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alchemy</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ape</span>

<span class="c1"># Use the provider configured as the default for the arbitrum::mainnet network.</span>
<span class="c1"># In this case, it will use the &quot;alchemy&quot; provider.</span>
<span class="k">with</span> <span class="n">ape</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">arbitrum</span><span class="o">.</span><span class="n">mainnet</span><span class="o">.</span><span class="n">use_default_provider</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>You can also use the <a class="reference external" href="../methoddocs/managers.html#ape.managers.networks.NetworkManager.parse_network_choice">parse_network_choice()</a> method when working with network choice strings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">networks</span>

<span class="c1"># Same as doing `networks.ethereum.local.use_provider(&quot;test&quot;)`.</span>
<span class="k">with</span> <span class="n">networks</span><span class="o">.</span><span class="n">parse_network_choice</span><span class="p">(</span><span class="s2">&quot;ethereum:local:test&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">provider</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">provider</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>A note about disconnect</strong>: Providers do not disconnect until the very end of your Python session.
This is so you can easily switch network contexts in a bridge or multi-chain environment, which happens in fixtures and other sessions out of Ape’s control.
However, sometimes you may definitely want your temporary network session to end before continuing, in which case you can use the <code class="docutils literal notranslate"><span class="pre">disconnect_after=True</span></code> kwarg:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">networks</span>

<span class="k">with</span> <span class="n">networks</span><span class="o">.</span><span class="n">parse_network_choice</span><span class="p">(</span><span class="s2">&quot;ethereum:local:foundry&quot;</span><span class="p">,</span> <span class="n">disconnect_after</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">provider</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">provider</span><span class="p">)</span>
</pre></div>
</div>
<section id="forked-context">
<h3>Forked Context<a class="headerlink" href="#forked-context" title="Permalink to this heading"></a></h3>
<p>Using the <code class="docutils literal notranslate"><span class="pre">networks.fork()</span></code> method, you can achieve similar effects to using a forked network with <code class="docutils literal notranslate"><span class="pre">disconnect_after=True</span></code>.
For example, let’s say we are running the following script on the network <code class="docutils literal notranslate"><span class="pre">ethereum:mainnet</span></code>.
We can switch to a forked network by doing this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">networks</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">networks</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span><span class="n">provider_name</span><span class="o">=</span><span class="s2">&quot;foundry&quot;</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="c1"># Do stuff on a local, forked version of mainnet</span>

    <span class="c1"># Switch back to mainnet.</span>
</pre></div>
</div>
<p>Learn more about forking networks in the <a class="reference external" href="./forking_networks.html">forked-networks guide</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data.html" class="btn btn-neutral float-left" title="Querying Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="forking_networks.html" class="btn btn-neutral float-right" title="Forking Networks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ApeWorX LTD.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  
      <li><a href="https://github.com/ApeWorX/ape
      /blob/main//docs/userguides/networks.rst">
      Show on GitHub</a></li>
  

</body>
</html>