<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accounts &mdash; ape  documentation</title>
      <link rel="stylesheet" href="/ape/latest/_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="/ape/latest/_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="/ape/latest/_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="/ape/userguides/accounts.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script data-domain="docs.apeworx.io" defer="defer" src="https://plausible.io/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/custom.js"></script>
  <script>
      var PROJECT = "ape";
  </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plugins" href="installing_plugins.html" />
    <link rel="prev" title="Overview" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ape
              <img src="../_static/logo.gif" class="logo" alt="Logo"/>
          </a>

          <div class="version">
            <label for="version-picker" id="version-picker-label">Version:</label>
            <select id="version-picker">
              <option value="">Select version...</option>
              <option value="latest">latest</option>
              <option value="stable">stable</option>
                <option value="v0.7.19">v0.7.19</option>
                <option value="v0.7.18">v0.7.18</option>
                <option value="v0.7.17">v0.7.17</option>
                <option value="v0.7.16">v0.7.16</option>
                <option value="v0.7.15">v0.7.15</option>
                <option value="v0.7.14">v0.7.14</option>
                <option value="v0.7.12">v0.7.12</option>
                <option value="v0.7.11">v0.7.11</option>
                <option value="v0.7.10">v0.7.10</option>
                <option value="v0.7.9">v0.7.9</option>
                <option value="v0.7.8">v0.7.8</option>
                <option value="v0.7.7">v0.7.7</option>
                <option value="v0.7.6">v0.7.6</option>
                <option value="v0.7.5">v0.7.5</option>
                <option value="v0.7.4">v0.7.4</option>
                <option value="v0.7.3">v0.7.3</option>
                <option value="v0.7.2">v0.7.2</option>
                <option value="v0.7.1">v0.7.1</option>
                <option value="v0.7.0">v0.7.0</option>
                <option value="v0.6.27">v0.6.27</option>
                <option value="v0.6.26">v0.6.26</option>
                <option value="v0.6.25">v0.6.25</option>
                <option value="v0.6.24">v0.6.24</option>
                <option value="v0.6.23">v0.6.23</option>
                <option value="v0.6.22">v0.6.22</option>
                <option value="v0.6.21">v0.6.21</option>
                <option value="v0.6.20">v0.6.20</option>
                <option value="v0.6.19">v0.6.19</option>
                <option value="v0.6.18">v0.6.18</option>
                <option value="v0.6.17">v0.6.17</option>
                <option value="v0.6.16">v0.6.16</option>
                <option value="v0.6.15">v0.6.15</option>
                <option value="v0.6.14">v0.6.14</option>
                <option value="v0.6.13">v0.6.13</option>
                <option value="v0.6.12">v0.6.12</option>
                <option value="v0.6.11">v0.6.11</option>
                <option value="v0.6.10">v0.6.10</option>
                <option value="v0.6.9">v0.6.9</option>
                <option value="v0.6.8">v0.6.8</option>
                <option value="v0.6.7">v0.6.7</option>
                <option value="v0.6.6">v0.6.6</option>
                <option value="v0.6.5">v0.6.5</option>
                <option value="v0.6.4">v0.6.4</option>
                <option value="v0.6.3">v0.6.3</option>
                <option value="v0.6.2">v0.6.2</option>
                <option value="v0.6.1">v0.6.1</option>
                <option value="v0.6.0">v0.6.0</option>
                <option value="v0.5.9">v0.5.9</option>
                <option value="v0.5.8">v0.5.8</option>
                <option value="v0.5.7">v0.5.7</option>
                <option value="v0.5.6">v0.5.6</option>
                <option value="v0.5.5">v0.5.5</option>
                <option value="v0.5.4">v0.5.4</option>
                <option value="v0.5.3">v0.5.3</option>
                <option value="v0.5.2">v0.5.2</option>
                <option value="v0.5.1">v0.5.1</option>
                <option value="v0.5.0">v0.5.0</option>
                <option value="v0.4.5">v0.4.5</option>
                <option value="v0.4.4">v0.4.4</option>
                <option value="v0.4.3">v0.4.3</option>
                <option value="v0.4.2">v0.4.2</option>
                <option value="v0.4.1">v0.4.1</option>
                <option value="v0.4.0">v0.4.0</option>
                <option value="v0.3.5">v0.3.5</option>
                <option value="v0.3.4">v0.3.4</option>
                <option value="v0.3.3">v0.3.3</option>
                <option value="v0.3.2">v0.3.2</option>
                <option value="v0.3.1">v0.3.1</option>
                <option value="v0.3.0">v0.3.0</option>
                <option value="v0.2.8">v0.2.8</option>
                <option value="v0.2.7">v0.2.7</option>
                <option value="v0.2.6">v0.2.6</option>
                <option value="v0.2.5">v0.2.5</option>
                <option value="v0.2.4">v0.2.4</option>
                <option value="v0.2.3">v0.2.3</option>
                <option value="v0.2.2">v0.2.2</option>
                <option value="v0.2.1">v0.2.1</option>
                <option value="v0.2.0">v0.2.0</option>
                <option value="v0.1.6">v0.1.6</option>
                <option value="v0.1.5">v0.1.5</option>
                <option value="v0.1.4">v0.1.4</option>
                <option value="v0.1.3">v0.1.3</option>
                <option value="v0.1.1">v0.1.1</option>
                <option value="v0.1.0">v0.1.0</option>
            </select>
          </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Accounts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#test-accounts">Test Accounts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-test-accounts-in-tests">Use test accounts in tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-test-accounts-outside-of-tests">Use test accounts outside of tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-new-test-accounts">Creating new test accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default-sender-support">Default Sender Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#live-network-accounts">Live Network Accounts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#keyfile-accounts">Keyfile Accounts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-new-accounts">Generating New Accounts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#importing-existing-accounts">Importing Existing Accounts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-accounts">Exporting Accounts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Default Sender Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#signing-messages">Signing Messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eip-712">EIP-712</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verifying-signature">Verifying Signature</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#automation">Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-wallets">Hardware Wallets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installing_plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Developing Projects with Ape</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="compile.html">Compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="clis.html">CLIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Querying Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="forking_networks.html">Forking Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing_plugins.html">Developing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configure Ape</a></li>
<li class="toctree-l1"><a class="reference internal" href="transactions.html">Making Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html">Ape Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="contracts.html">Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="publishing.html">Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../commands/accounts.html">accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/compile.html">compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/pm.html">pm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/console.html">console</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/init.html">init</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/networks.html">networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/plugins.html">plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/run.html">run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/test.html">test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape.html">ape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/ape_accounts.html">ape-accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/api.html">ape.api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/cli.html">ape.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/contracts.html">ape.contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/exceptions.html">ape.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/managers.html">ape.managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/plugins.html">ape.plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/types.html">ape.types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methoddocs/utils.html">ape.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ape</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Accounts</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ApeWorX/ape/blob/main/docs/userguides/accounts.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="accounts">
<h1>Accounts<a class="headerlink" href="#accounts" title="Permalink to this heading"></a></h1>
<p>Accounts in Ape come from <a class="reference external" href="../methoddocs/api.html#ape.api.accounts.AccountAPI">AccountAPI</a> implementations (e.g. from plugins).
There are typically two types of accounts:</p>
<ol class="arabic simple">
<li><p>Test accounts</p></li>
<li><p>Live network accounts</p></li>
</ol>
<p>Test accounts are useful for local network testing and debugging contracts.
Live network accounts are for interacting with live blockchains and should be secured.</p>
<p>To learn more about Ethereum accounts, see <a class="reference external" href="https://ethereum.org/en/developers/docs/accounts/">the Ethereum documentation</a>.</p>
<section id="test-accounts">
<h2>Test Accounts<a class="headerlink" href="#test-accounts" title="Permalink to this heading"></a></h2>
<p>Ape ships with pytest fixtures to assist in writing your tests.</p>
<section id="use-test-accounts-in-tests">
<h3>Use test accounts in tests<a class="headerlink" href="#use-test-accounts-in-tests" title="Permalink to this heading"></a></h3>
<p>Pre-funded test accounts are accessible via the <a class="reference external" href="./testing.html#accounts-fixture">accounts fixture</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_my_contract_method</span><span class="p">(</span><span class="n">accounts</span><span class="p">):</span>
    <span class="n">sender</span> <span class="o">=</span> <span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="use-test-accounts-outside-of-tests">
<h3>Use test accounts outside of tests<a class="headerlink" href="#use-test-accounts-outside-of-tests" title="Permalink to this heading"></a></h3>
<p>To access the same prefunded accounts in your scripts or console, use the root <code class="docutils literal notranslate"><span class="pre">accounts</span></code> object and the <a class="reference external" href="../methoddocs/managers.html#ape.managers.accounts.AccountManager.test_accounts">test_accounts</a> property:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>

<span class="n">sender</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">test_accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>You can configure your test accounts using your <code class="docutils literal notranslate"><span class="pre">ape-config.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mnemonic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test test test test test test test test test test test junk</span>
<span class="w">  </span><span class="nt">number_of_accounts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</pre></div>
</div>
<p><strong>WARN</strong>: NEVER put a seed phrase with real funds here.
The accounts generated from this seed are solely for testing and debugging purposes.</p>
</section>
<section id="creating-new-test-accounts">
<h3>Creating new test accounts<a class="headerlink" href="#creating-new-test-accounts" title="Permalink to this heading"></a></h3>
<p>You can create a new test account by doing the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">test_accounts</span><span class="o">.</span><span class="n">generate_test_account</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Creating a new test account means it will be unfunded by default.</p>
<p>Learn more about test accounts from the <a class="reference external" href="./testing.html#accounts-fixture">testing guide</a>.</p>
<p>If your testing provider supports this feature, it is possible to directly set the balances of any address by performing the following action:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">account</span><span class="o">.</span><span class="n">balance</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e18</span><span class="p">)</span>  <span class="c1"># Gives `account` 1 Ether</span>
</pre></div>
</div>
</section>
<section id="default-sender-support">
<h3>Default Sender Support<a class="headerlink" href="#default-sender-support" title="Permalink to this heading"></a></h3>
<p>In order to eliminate the usage of sender in contract calls, you can use <code class="docutils literal notranslate"><span class="pre">use_sender</span></code> context manager.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="c1"># Use first account from test mnemonic</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="s2">&quot;&lt;address&gt;&quot;</span><span class="p">):</span> <span class="c1"># Impersonate an account</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="c1"># a is a `TestAccountAPI` object</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="live-network-accounts">
<h2>Live Network Accounts<a class="headerlink" href="#live-network-accounts" title="Permalink to this heading"></a></h2>
<p>When using live networks, you need to get your accounts into Ape.
To get your accounts in Ape, you must use an <code class="docutils literal notranslate"><span class="pre">accounts</span></code> plugin.
Ape ships with a keyfile-based account plugin, but you can use any account plugin such as <code class="docutils literal notranslate"><span class="pre">ape-ledger</span></code>, <code class="docutils literal notranslate"><span class="pre">ape-trezor</span></code>, or a third-party plugin.</p>
<section id="keyfile-accounts">
<h3>Keyfile Accounts<a class="headerlink" href="#keyfile-accounts" title="Permalink to this heading"></a></h3>
<p>Ape ships with a keyfile-based account plugin that lets you import and generate accounts.
The premise of the plugin is that accounts are stored locally on your computer in the <code class="docutils literal notranslate"><span class="pre">$HOME/.ape/accounts</span></code> directory following the <code class="docutils literal notranslate"><span class="pre">keyfile</span></code> structure.
Under-the-hood, this structure comes from the <a class="reference external" href="https://github.com/ethereum/eth-keyfile">eth-keyfile library</a> via the <a class="reference external" href="https://eth-account.readthedocs.io/en/stable/eth_account.html">eth-account</a> package.
When Ape creates the keyfile, either from import or account-generation (described below!), it prompts you for a passphrase to use for encrypting the keyfile, similarly to how you would use a password in browser-based wallets.
The keyfile stores the private key in an encrypted-at-rest state, which maximizes security of the locally-stored key material.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ape-accounts</span></code> core plugin lets you use keyfile-based account to sign messages and transactions.
When signing a message or transaction using an account from <code class="docutils literal notranslate"><span class="pre">ape-accounts</span></code>, you will be prompted to enter the passphrase you specified when importing or generating that account.</p>
<p>All the available CLI commands for this account’s plugin can be found <a class="reference external" href="../commands/accounts.html">here</a>.</p>
<section id="generating-new-accounts">
<h4>Generating New Accounts<a class="headerlink" href="#generating-new-accounts" title="Permalink to this heading"></a></h4>
<p>You can <a class="reference external" href="../commands/accounts.html#accounts-generate">generate</a> an account:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>generate<span class="w"> </span>&lt;ALIAS&gt;
</pre></div>
</div>
<p>Ape will prompt you for entropy which is used to increase randomness when creating your account.
Ape will then prompt you whether you want to show your mnemonic.
If you do not want to see your mnemonic you can select <code class="docutils literal notranslate"><span class="pre">n</span></code>.
Alternatively, you can use the <code class="docutils literal notranslate"><span class="pre">--hide-mnemonic</span></code> option to skip the prompt.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>generate<span class="w"> </span>&lt;ALIAS&gt;<span class="w"> </span>--hide-mnemonic
</pre></div>
</div>
<p>If you elected to show your mnemonic Ape will then show you your newly generated mnemonic.
Ape will then prompt you for a passphrase which you will need to enter twice to confirm.
This passphrase is used to encrypt your account on disk, for extra security.
You will be prompted for it each time you load your account, so make sure to remember it.
After entering the passphrase Ape will then show you your new account address, HDPath, and account alias.
If you want to use a custom HDPath, use the <code class="docutils literal notranslate"><span class="pre">--hd-path</span></code> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>generate<span class="w"> </span>&lt;ALIAS&gt;<span class="w"> </span>--hd-path<span class="w"> </span>&lt;HDPATH&gt;
</pre></div>
</div>
<p>If you do not use the <code class="docutils literal notranslate"><span class="pre">--hd-path</span></code> option, Ape will use the default HDPath of (Ethereum network, first account).
If you want to use a custom mnemonic phrase word length, use the <code class="docutils literal notranslate"><span class="pre">--word-count</span></code> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>generate<span class="w"> </span>&lt;ALIAS&gt;<span class="w"> </span>--word-count<span class="w"> </span>&lt;WORDCOUNT&gt;
</pre></div>
</div>
<p>If you do not use the <code class="docutils literal notranslate"><span class="pre">--word-count</span></code> option, Ape will use the default word count of 12.
You can use all of these together or separately to control the way Ape creates and displays your account information.</p>
<p>This same functionality is also scriptable with the same inputs as the <code class="docutils literal notranslate"><span class="pre">generate</span></code> command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape_accounts</span> <span class="kn">import</span> <span class="n">generate_account</span>

<span class="n">account</span><span class="p">,</span> <span class="n">mnemonic</span> <span class="o">=</span> <span class="n">generate_account</span><span class="p">(</span><span class="s2">&quot;my-account&quot;</span><span class="p">,</span> <span class="s2">&quot;mySecureP@ssphrase&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Save your mnemonic: </span><span class="si">{</span><span class="n">mnemonic</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Your new account address is: </span><span class="si">{</span><span class="n">account</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="../methoddocs/ape_accounts.html#ape_accounts.generate_account">documentation for <code class="docutils literal notranslate"><span class="pre">generate_account()</span></code></a> for more options.</p>
</section>
<section id="importing-existing-accounts">
<h4>Importing Existing Accounts<a class="headerlink" href="#importing-existing-accounts" title="Permalink to this heading"></a></h4>
<p>If you already have an account and wish to import it into Ape (say, from Metamask), you can use the <a class="reference external" href="../commands/accounts.html#accounts-import">import command</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>import<span class="w"> </span>&lt;ALIAS&gt;
</pre></div>
</div>
<p>It will prompt you for the private key.
If you need help exporting your private key from Metamask, see <a class="reference external" href="https://metamask.zendesk.com/hc/en-us/articles/360015289632-How-to-export-an-account-s-private-key">this guide</a>.
You can also import accounts from mnemonic seed by using the <code class="docutils literal notranslate"><span class="pre">--use-mnemonic</span></code> flag:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>import<span class="w"> </span>&lt;ALIAS&gt;<span class="w"> </span>--use-mnemonic
</pre></div>
</div>
<p>It will then prompt you for the <a class="reference external" href="https://en.bitcoin.it/wiki/Seed_phrase">mnemonic seed</a>.
If you need help finding your mnemonic seed (Secret Recovery Phrase) in Metamask, see <a class="reference external" href="https://metamask.zendesk.com/hc/en-us/articles/360015290032-How-to-reveal-your-Secret-Recovery-Phrase">this guide</a>.
In addition, you can also use a custom HDPath by using the <code class="docutils literal notranslate"><span class="pre">--hd-path</span></code> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span>import<span class="w"> </span>&lt;ALIAS&gt;<span class="w"> </span>--use-mnemonic<span class="w"> </span>--hd-path<span class="w"> </span>&lt;HDPATH&gt;
</pre></div>
</div>
<p>If you use the <code class="docutils literal notranslate"><span class="pre">--hd-path</span></code> option, you will need to pass the <a class="reference external" href="https://help.myetherwallet.com/en/articles/5867305-hd-wallets-and-derivation-paths">HDPath</a> you’d like to use as an argument in the command.
If you do not use the <code class="docutils literal notranslate"><span class="pre">--hd-path</span></code> option, Ape will use the default HDPath of (Ethereum network, first account).</p>
<p>You can import an account programatically using a seed phrase <a class="reference external" href="../methoddocs/ape_accounts.html#ape_accounts.import_account_from_mnemonic">using <code class="docutils literal notranslate"><span class="pre">import_account_from_mnemonic()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape_accounts</span> <span class="kn">import</span> <span class="n">import_account_from_mnemonic</span>

<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;my-account&quot;</span>
<span class="n">passphrase</span> <span class="o">=</span> <span class="s2">&quot;my$ecurePassphrase&quot;</span>
<span class="n">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;test test test test test test test test test test test junk&quot;</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">import_account_from_mnemonic</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">,</span> <span class="n">mnemonic</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Your imported account address is: </span><span class="si">{</span><span class="n">account</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or using a raw private key <a class="reference external" href="../methoddocs/ape_accounts.html#ape_accounts.import_account_from_private_key">using <code class="docutils literal notranslate"><span class="pre">import_account_from_private_key()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">ape_accounts</span> <span class="kn">import</span> <span class="n">import_account_from_private_key</span>

<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;my-account&quot;</span>
<span class="n">passphrase</span> <span class="o">=</span> <span class="s2">&quot;my SecurePassphrase&quot;</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">import_account_from_private_key</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Your imported account address is: </span><span class="si">{</span><span class="n">account</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exporting-accounts">
<h4>Exporting Accounts<a class="headerlink" href="#exporting-accounts" title="Permalink to this heading"></a></h4>
<p>You can also <a class="reference external" href="../commands/accounts.html#accounts-export">export</a> the private key of an account:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>accounts<span class="w"> </span><span class="nb">export</span><span class="w"> </span>&lt;ALIAS&gt;
</pre></div>
</div>
<p>Ape will ask you for the password to the account and then give you the private key of that account.
You can then use that private key with <a class="reference external" href="../commands/accounts.html#accounts-import">import</a>.
You can alternatively load the private key into <a class="reference external" href="https://metamask.zendesk.com/hc/en-us/articles/360015489331-How-to-import-an-account#h_01G01W07NV7Q94M7P1EBD5BYM4">Metamask wallet</a>.
Then, in your scripts, you can <a class="reference external" href="../methoddocs/managers.html#ape.managers.accounts.AccountManager.load">load</a> an account:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;ALIAS&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id1">
<h3>Default Sender Support<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>In order to reduce repetition of adding <code class="docutils literal notranslate"><span class="pre">sender</span></code> in your contract calls, you can use <code class="docutils literal notranslate"><span class="pre">use_sender</span></code> context manager.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="s2">&quot;&lt;address&gt;&quot;</span><span class="p">):</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="s2">&quot;&lt;alias&gt;&quot;</span><span class="p">):</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">accounts</span><span class="o">.</span><span class="n">use_sender</span><span class="p">(</span><span class="n">a</span><span class="p">):</span> <span class="c1"># a is a `AccountAPI` object</span>
  <span class="n">contract</span><span class="o">.</span><span class="n">myFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="signing-messages">
<h2>Signing Messages<a class="headerlink" href="#signing-messages" title="Permalink to this heading"></a></h2>
<p>You can sign messages with your accounts in Ape.
To do this, use the <a class="reference external" href="../methoddocs/api.html#ape.api.accounts.AccountAPI.sign_message">sign_message</a> API.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>
<span class="kn">from</span> <span class="nn">eth_account.messages</span> <span class="kn">import</span> <span class="n">encode_defunct</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;ALIAS&gt;&quot;</span><span class="p">)</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">encode_defunct</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hello Apes!&quot;</span><span class="p">)</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">sign_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Ape’s <code class="docutils literal notranslate"><span class="pre">sign_message</span></code> API intentionally accepts <code class="docutils literal notranslate"><span class="pre">Any</span></code> as the message argument type.
Account plugins decide what data-types to support.
Most Ethereum account plugins, such as <code class="docutils literal notranslate"><span class="pre">ape-account</span></code>, are able to sign messages like the example above.
However, you can also provide other types, such as a <code class="docutils literal notranslate"><span class="pre">str</span></code> directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;ALIAS&gt;&quot;</span><span class="p">)</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">sign_message</span><span class="p">(</span><span class="s2">&quot;Hello Apes!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="eip-712">
<h3>EIP-712<a class="headerlink" href="#eip-712" title="Permalink to this heading"></a></h3>
<p>Some account plugins are able to sign EIP-712 structured message types by utilizing the <code class="docutils literal notranslate"><span class="pre">eip712</span></code> package.
Here is an example with custom EIP-712 classes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>
<span class="kn">from</span> <span class="nn">eip712.messages</span> <span class="kn">import</span> <span class="n">EIP712Message</span><span class="p">,</span> <span class="n">EIP712Type</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">EIP712Type</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
    <span class="n">wallet</span><span class="p">:</span> <span class="s2">&quot;address&quot;</span>

<span class="k">class</span> <span class="nc">Mail</span><span class="p">(</span><span class="n">EIP712Message</span><span class="p">):</span>
    <span class="n">_chainId_</span><span class="p">:</span> <span class="s2">&quot;uint256&quot;</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_name_</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="o">=</span> <span class="s2">&quot;Ether Mail&quot;</span>
    <span class="n">_verifyingContract_</span><span class="p">:</span> <span class="s2">&quot;address&quot;</span> <span class="o">=</span> <span class="s2">&quot;0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC&quot;</span>
    <span class="n">_version_</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>

    <span class="n">sender</span><span class="p">:</span> <span class="n">Person</span>
    <span class="n">receiver</span><span class="p">:</span> <span class="n">Person</span>

<span class="n">alice</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="n">wallet</span><span class="o">=</span><span class="s2">&quot;0xCD2a3d9F938E13CD947Ec05AbC7FE734Df8DD826&quot;</span><span class="p">)</span>
<span class="n">bob</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;0xB0B0b0b0b0b0B000000000000000000000000000&quot;</span><span class="p">)</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">Mail</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="n">alice</span><span class="p">,</span> <span class="n">receiver</span><span class="o">=</span><span class="n">bob</span><span class="p">)</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;ALIAS&gt;&quot;</span><span class="p">)</span>
<span class="n">account</span><span class="o">.</span><span class="n">sign_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="verifying-signature">
<h3>Verifying Signature<a class="headerlink" href="#verifying-signature" title="Permalink to this heading"></a></h3>
<p>Verify the signatures on your signed messages by using the <a class="reference external" href="../methoddocs/types.html#ape.types.signatures.recover_signer">recover_signer</a> function or the <a class="reference external" href="../methoddocs/api.html#ape.api.accounts.AccountAPI.check_signature">check_signature</a> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>
<span class="kn">from</span> <span class="nn">ape.types.signatures</span> <span class="kn">import</span> <span class="n">recover_signer</span>
<span class="kn">from</span> <span class="nn">eth_account.messages</span> <span class="kn">import</span> <span class="n">encode_defunct</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;ALIAS&gt;&quot;</span><span class="p">)</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">encode_defunct</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hello Apes!&quot;</span><span class="p">)</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">sign_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="c1"># Validate the signature by recovering the signer and asserting it is equal to the sender.</span>
<span class="n">recovered_signer</span> <span class="o">=</span> <span class="n">recover_signer</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">recovered_signer</span> <span class="o">==</span> <span class="n">account</span><span class="o">.</span><span class="n">address</span>

<span class="c1"># NOTE: You can also use the `check_signature` method on an account, which returns a bool.</span>
<span class="k">assert</span> <span class="n">account</span><span class="o">.</span><span class="n">check_signature</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="automation">
<h2>Automation<a class="headerlink" href="#automation" title="Permalink to this heading"></a></h2>
<p>If you use your keyfile accounts in automation, such as CI/CD, you may need to programmatically unlock them and enable auto-sign.
To do this, use a special environment variable for the account’s passphrase:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span>APE_ACCOUNTS_&lt;alias&gt;_PASSPHRASE<span class="o">=</span><span class="s2">&quot;a&quot;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;alias&gt;</span></code> is the name of the account you want to use.
Now, you can use your account to make any transactions without subsequently providing your passphrase.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ape</span> <span class="kn">import</span> <span class="n">accounts</span>
<span class="kn">from</span> <span class="nn">eth_account.messages</span> <span class="kn">import</span> <span class="n">encode_defunct</span>

<span class="n">account</span> <span class="o">=</span> <span class="n">accounts</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;ALIAS&gt;&quot;</span><span class="p">)</span>
<span class="n">account</span><span class="o">.</span><span class="n">set_autosign</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Now, you will not be prompted to sign messages or transactions</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">encode_defunct</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hello Apes!&quot;</span><span class="p">)</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">sign_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Alternatively, you may use the <code class="docutils literal notranslate"><span class="pre">passphrase=</span></code> kwarg on methods <code class="docutils literal notranslate"><span class="pre">account.set_autosign()</span></code> and <code class="docutils literal notranslate"><span class="pre">account.unlock()</span></code>, but we highly recommend using the environment variable approach to avoid accidentally leaking your passphrase.</p>
</section>
<section id="hardware-wallets">
<h2>Hardware Wallets<a class="headerlink" href="#hardware-wallets" title="Permalink to this heading"></a></h2>
<p>Because of the plugin system in Ape, we are able to support other types of accounts including hardware wallet accounts.
Check out these plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ApeWorX/ape-ledger">ape-ledger</a></p></li>
<li><p><a class="reference external" href="https://github.com/ApeWorX/ape-trezor">ape-trezor</a></p></li>
</ul>
<p>To install one of these plugins, do the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ape<span class="w"> </span>plugins<span class="w"> </span>install<span class="w"> </span>ledger
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="installing_plugins.html" class="btn btn-neutral float-right" title="Plugins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ApeWorX LTD.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  
      <li><a href="https://github.com/ApeWorX/ape
      /blob/main//docs/userguides/accounts.rst">
      Show on GitHub</a></li>
  

</body>
</html>